11.29-12.05 周进展报告
==================

一、风险评估体系重构 (Risk Assessment Framework Overhaul)
---------------------------------------------------

### 1. 风险等级与维度重构
- **简化风险等级**：将原有的“高/中/低”三级风险体系简化为 **“高/低”** 两级，移除了界限模糊的“中风险”，使评估结果更明确。
- **引入八维评估体系**：在高风险条款的卡片中新增了 **风险维度标签**（如“权利对等性”、“核心义务”等），基于 `configs/risk_standards.yaml` 定义的八大维度进行分类展示。
- **低风险标准化**：对低风险条款的输出进行了标准化处理。报告中不再显示“违规点”和“法律依据”，而是统一展示中性的风险简述（“条款内容未涉及典型风险点...”）和建议，避免给用户造成不必要的恐慌。

### 2. 风险误召回过滤 (False Positive Filtering)
为了解决大模型偶尔产生的“幻觉”风险（即条款实际无风险但被标记为高风险），引入了多层过滤机制：
- **预处理层 (`preprocessor.py`)**：
    - **条款分类**：基于正则将条款分为“信息类”、“定义类”、“权利义务类”等。
    - **结构过滤**：对动词缺失的“信息/定义类”条款直接判定为低风险。
    - **适用性过滤**：仅允许风险规则在适用的条款类别中检索（如“管辖风险”仅在“争议解决类”条款中检索）。
- **相关性强制判断**：在 LLM Prompt 中增加了 **“相关性强制判断规则”**。要求 LLM 必须检测条款中是否包含风险点的“核心动词”或“典型措辞”。若缺失，强制判定为低风险。
- **一致性检查**：在代码层增加了后处理逻辑。若 LLM 的分析文本中包含“不构成该风险点”等否定表述，系统会强制将风险等级修正为“低”，解决了分析与评级不一致的问题。

二、系统稳定性与兼容性优化
------------------------

### 1. Word 报告兼容性
- **移除 Emoji**：解决了大模型输出的 Emoji（如 🔴、🟢）在生成的 Word 报告中显示乱码的问题，将其替换为纯文本标记（【高风险】、【低风险】），确保了文档的专业性和兼容性。

### 2. 检索精度提升
- **混合检索优化**：优化了 `HybridSearcher`，支持传入 `allowed_indices` 参数，使得检索过程可以限定在预处理筛选出的规则子集中进行，提高了检索的准确性和效率。
- **法条匹配修复**：修复了法条检索逻辑，从模糊匹配改为后缀匹配，解决了“劳动合同法”误匹配到“实施条例”的问题。


