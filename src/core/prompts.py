"""
ç»Ÿä¸€çš„ Prompt æ¨¡æ¿ç®¡ç†æ¨¡å—

é›†ä¸­ç®¡ç†æ‰€æœ‰ç”¨äºåˆåŒå®¡æŸ¥çš„ Prompt æ¨¡æ¿ï¼Œä¾›ä»¥ä¸‹æ¨¡å—ç»Ÿä¸€è°ƒç”¨ï¼š
- engine.py (å®é™…å·¥ä½œæµ)
- ablation_benchmark.py (è¯„æµ‹è„šæœ¬)
- llm.py (LLM å®¢æˆ·ç«¯)
"""

# ============================================================================
# è¯„æµ‹æ¨¡å¼ Promptï¼ˆablation_benchmark.py ä½¿ç”¨ï¼‰
# ============================================================================

# æ¨¡å¼1ï¼šçº¯LLMï¼Œæœ€ç®€å•çš„è¾“å…¥
RAW_LLM_PROMPT = """è¯·åˆ†æä»¥ä¸‹åˆåŒæ¡æ¬¾æ˜¯å¦å­˜åœ¨é£é™©ï¼š

{clause}

è¯·æŒ‰ä»¥ä¸‹æ ¼å¼è¾“å‡ºï¼š
## é£é™©ï¼š[é£é™©ç®€è¿°]
- **ç­‰çº§**ï¼š[é«˜/ä¸­/ä½]
- **è¯æ®**ï¼š[è¯æ®æ‘˜å½•]
- **åˆ†æ**ï¼š[åˆ†æå†…å®¹]
- **æ³•æ¡**ï¼š[ç›¸å…³æ³•æ¡]
- **å»ºè®®**ï¼š[ä¿®æ”¹å»ºè®®]
"""

# æ¨¡å¼2ï¼šåŸºç¡€Promptï¼Œæœ‰æ ¼å¼çº¦æŸå’Œè§’è‰²å®šä¹‰ï¼Œä½†æ— è§„åˆ™å¼•æ“
BASIC_PROMPT = """ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„åˆåŒæ³•å¾‹é¡¾é—®ï¼Œè¯·åˆ†æä»¥ä¸‹åˆåŒæ¡æ¬¾æ˜¯å¦å­˜åœ¨é£é™©ã€‚

### æ¡æ¬¾åŸæ–‡
{clause}

### é£é™©å®šçº§æ ‡å‡†
1. **é«˜é£é™©**ï¼šæ¡æ¬¾æ˜æ˜¾è¿åæ³•å¾‹å¼ºåˆ¶æ€§è§„å®šï¼Œå¯¼è‡´æ— æ•ˆ/è¿æ³•/åŒå€èµ”å¿ã€‚
2. **ä¸­é£é™©**ï¼šæ¡æ¬¾è¡¨è¿°æ¨¡ç³Šã€å­˜åœ¨æ­§ä¹‰ï¼Œæˆ–æ˜¾å¤±å…¬å¹³ä½†æœªç›´æ¥è¿æ³•ã€‚
3. **ä½é£é™©**ï¼šæ¡æ¬¾å­˜åœ¨è½»å¾®ç‘•ç–µï¼Œä½†æ³•å¾‹æœ‰å…œåº•è§„å®šã€‚

### è¾“å‡ºè¦æ±‚
è¯·æŒ‰ä»¥ä¸‹Markdownæ ¼å¼è¾“å‡ºï¼ˆä¸è¦åŒ…å«```markdownæ ‡è®°ï¼‰ï¼š

## é£é™©ï¼š[é£é™©ç®€è¿°]
- **ç­‰çº§**ï¼š[é«˜/ä¸­/ä½]
- **è¯æ®**ï¼š[ä»æ¡æ¬¾åŸæ–‡ä¸­é€å­—æ‘˜å½•èƒ½è¯æ˜è¯¥é£é™©çš„å…³é”®è¯­å¥ï¼Œç”¨ã€Œã€æ‹¬èµ·æ¥]
- **åˆ†æ**ï¼š[è¯¦ç»†åˆ†æï¼Œ100å­—ä»¥å†…]
- **æ³•æ¡**ï¼š[ç›¸å…³æ³•æ¡ï¼Œè‹¥æ— åˆ™ç•™ç©º]
- **å»ºè®®**ï¼š[é’ˆå¯¹æ€§çš„ä¿®æ”¹å»ºè®®]
"""

# æ¨¡å¼3ï¼šå½“å‰å·¥ä½œæµPromptï¼ˆå¼•å…¥"æ‹’è¯†"æŒ‡ä»¤å’Œå®è´¨ç›¸å…³æ€§æ£€æŸ¥ï¼‰
CURRENT_WORKFLOW_PROMPT = """ä½ æ˜¯èµ„æ·±åˆåŒå¾‹å¸ˆã€‚è¯·åŸºäºã€å‚è€ƒä¿¡æ¯ã€‘å’Œã€é£é™©å®šçº§æ ‡å‡†ã€‘å¯¹ä»¥ä¸‹åˆåŒæ¡æ¬¾è¿›è¡Œåˆè§„å®¡æŸ¥ã€‚

### ğŸ“„ å¾…å®¡æ¡æ¬¾
{clause}

### ğŸ“š å‚è€ƒä¿¡æ¯ (å·²åŒ¹é…é£é™©åº“ - å¯èƒ½åŒ…å«ä¸ç›¸å…³ä¿¡æ¯)
{reference_info}

### âš–ï¸ é£é™©å®šçº§æ ‡å‡†
1. **é«˜é£é™©**ï¼šæ¡æ¬¾æ˜æ˜¾è¿åæ³•å¾‹å¼ºåˆ¶æ€§è§„å®šï¼ˆå¯¼è‡´æ— æ•ˆ/è¿æ³•ï¼‰ï¼›æˆ–è§¦å‘åéœ€æ”¯ä»˜åŒå€èµ”å¿/è¡Œæ”¿ç½šæ¬¾ï¼›æˆ–å¯¼è‡´æ ¸å¿ƒæƒç›Šï¼ˆå¦‚æ— å›ºå®šæœŸé™åˆåŒç­¾ç½²æƒï¼‰è¢«å‰¥å¤ºã€‚
2. **ä¸­é£é™©**ï¼šæ¡æ¬¾è¡¨è¿°æ¨¡ç³Šã€å­˜åœ¨è§£é‡Šæ­§ä¹‰ï¼›æˆ–ä¸¾è¯è´£ä»»å€’ç½®/è¿‡é«˜ï¼›æˆ–æ˜¾å¤±å…¬å¹³ä½†æœªç›´æ¥è¿æ³•ï¼ˆå±äºéšæ‚£ï¼‰ã€‚
3. **ä½é£é™©**ï¼šæ¡æ¬¾å­˜åœ¨è½»å¾®ç‘•ç–µï¼Œä½†æ³•å¾‹æœ‰å…œåº•è§„å®šï¼ˆè‡ªåŠ¨è¡¥ä½ï¼‰ï¼›æˆ–ä»…ä¸ºç¨‹åºæ€§ç¬”è¯¯ï¼Œä¸é€ æˆå®è´¨æŸå¤±ã€‚

âœ… æ­£ç¡®åˆ†æèŒƒä¾‹ï¼ˆå­¦ä¹ æ­¤æ‹’è¯†é€»è¾‘ï¼‰
æ¡æ¬¾ï¼š"ä¹™æ–¹æ¯æ—¥å·¥ä½œæ—¶é—´ä¸º8å°æ—¶ã€‚"
å‚è€ƒä¿¡æ¯ï¼š[é£é™©ç‚¹ï¼šåŠ ç­è´¹å‰¥å‰Š]...æœªæ”¯ä»˜åŠ ç­è´¹...
åˆ†æï¼šæ¡æ¬¾ä»…çº¦å®šæ ‡å‡†å·¥æ—¶ï¼Œæœªæ¶‰åŠåŠ ç­è´¹æ”¾å¼ƒæˆ–æ— å¿åŠ ç­ã€‚å‚è€ƒä¿¡æ¯çš„é£é™©é€»è¾‘ä¸æ¡æ¬¾å†…å®¹ä¸ç¬¦ã€‚
ç»“è®ºï¼šä½é£é™©ï¼ˆå¿½ç•¥å‚è€ƒä¿¡æ¯ï¼‰

### ğŸ“ å†™ä½œæŒ‡ä»¤
1. **ã€å…³é”®æ­¥éª¤ï¼šå‚è€ƒä¿¡æ¯çš„ç›¸å…³æ€§è¿‡æ»¤ã€‘**
   å‚è€ƒä¿¡æ¯ç”±æ£€ç´¢ç³»ç»Ÿæä¾›ï¼Œ**å¯èƒ½å­˜åœ¨é”™è¯¯æˆ–å™ªéŸ³**ã€‚åœ¨å¼•ç”¨å‰ï¼Œè¯·è¿›è¡Œä»¥ä¸‹åˆ¤æ–­ï¼š
   - **å®è´¨ç›¸å…³æ€§æ£€æŸ¥**ï¼šæ¡æ¬¾å†…å®¹çš„**å®é™…æ³•å¾‹åæœ**ï¼Œæ˜¯å¦çœŸçš„è§¦å‘äº†å‚è€ƒä¿¡æ¯ä¸­æè¿°çš„é£é™©é€»è¾‘ï¼Ÿ
   - **åå‘æ’é™¤**ï¼šå¦‚æœæ¡æ¬¾è¡¨è¿°æ˜¯åˆæ³•çš„ã€æ­£å¸¸çš„ï¼ˆå¦‚æ ‡å‡†å·¥æ—¶çº¦å®šï¼‰ï¼Œå³ä½¿å‚è€ƒä¿¡æ¯æç¤ºäº†é£é™©ï¼Œä¹Ÿå¿…é¡»**å¿½ç•¥å‚è€ƒä¿¡æ¯**ã€‚

   **åˆ¤å®šè§„åˆ™**ï¼š
   - è‹¥å‚è€ƒä¿¡æ¯ä¸ºç©ºæˆ–æ³¨æ˜â€œæ— â€ï¼Œè¯·åŸºäºã€ŠåŠ³åŠ¨åˆåŒæ³•ã€‹ç­‰é€šç”¨æ³•å¾‹å¸¸è¯†åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ˜æ˜¾è¿æ³•ç‚¹ã€‚è‹¥æ— æ˜æ˜¾è¿æ³•ï¼Œåº”ç›´æ¥åˆ¤å®šä¸ºâ€œä½é£é™©â€ã€‚
   - è‹¥å‚è€ƒä¿¡æ¯ä¸æ¡æ¬¾**ä¸æ„æˆå®è´¨ç›¸å…³**ï¼Œè¯·ç›´æ¥å¿½ç•¥è¯¥å‚è€ƒä¿¡æ¯ï¼ŒåŸºäºé€šç”¨æ³•å¾‹å¸¸è¯†åˆ¤å®šï¼ˆé€šå¸¸ä¸º"ä½é£é™©"ï¼‰ã€‚
   - æ­¤æ—¶åœ¨"åˆ†æ"ä¸­æ³¨æ˜ï¼š"å‚è€ƒä¿¡æ¯ä¸æ¡æ¬¾å†…å®¹æ— å®è´¨å…³è”ï¼ŒåŸºäºæ¡æ¬¾åŸæ–‡åˆ¤æ–­ä¸ºæ— æ˜æ˜¾é£é™©ã€‚"

2. **ã€é£é™©å®šçº§ä¸åˆ†ææ‰§è¡Œã€‘**
   - **è‹¥ç¡®è®¤ç›¸å…³ä¸”æœ‰é£é™©**ï¼šæ‰©å†™å‚è€ƒä¿¡æ¯çš„ä¸“å®¶é€»è¾‘ã€‚
     - **é«˜é£é™©**ï¼šå¿…é¡»æ˜ç¡®æŒ‡å‡ºè¿åäº†å“ªæ¡æ³•å¾‹å¼ºåˆ¶æ€§è§„å®šï¼ˆå¦‚ã€ŠåŠ³åŠ¨åˆåŒæ³•ã€‹ç¬¬XXæ¡ï¼‰ï¼Œæˆ–æŒ‡æ˜å…·ä½“çš„ç»æµèµ”å¿åæœï¼ˆå¦‚2Nèµ”å¿ï¼‰ã€‚
     - **ä¸­é£é™©**ï¼šé‡ç‚¹åˆ†ææ¡æ¬¾çš„æ¨¡ç³Šæ€§ã€éšå½¢é™·é˜±æˆ–ç»´æƒæˆæœ¬ã€‚
   - **è‹¥åˆ¤å®šä¸ºä½é£é™©**ï¼šç®€è¿°ç†ç”±ï¼ˆå¦‚ç¬¦åˆæ³•å¾‹è§„å®šã€æœ‰å…œåº•æ¡æ¬¾ï¼‰ã€‚

3. **ã€ç©ºä¸Šä¸‹æ–‡å¤„ç†è§„åˆ™ï¼ˆå®‰å…¨å…œåº•ï¼‰ã€‘**
   è‹¥ç» Reranker è¿‡æ»¤åã€å‚è€ƒä¿¡æ¯ã€‘ä¸ºç©ºï¼š
   - **é»˜è®¤åˆ¤å®š**ï¼šåŸåˆ™ä¸Šåº”åˆ¤å®šä¸ºã€ğŸŸ¢ ä½é£é™©ã€‘ã€‚
   - **ä¾‹å¤–æƒ…å½¢**ï¼šä»…å½“æ¡æ¬¾å­˜åœ¨**æåº¦æ˜æ˜¾çš„å¸¸è¯†æ€§è¿æ³•**ï¼ˆä¾‹å¦‚ï¼šä¸æ”¯ä»˜å·¥èµ„ã€æ‰£æŠ¼èº«ä»½è¯ã€é™åˆ¶äººèº«è‡ªç”±ã€ç¼´çº³å…¥èŒæŠ¼é‡‘ï¼‰æ—¶ï¼Œå¯åˆ¤å®šä¸ºé«˜é£é™©ã€‚
   - **é˜²å¹»è§‰çº¦æŸ**ï¼šåœ¨æ­¤æƒ…å†µä¸‹ï¼Œåˆ†ææ—¶**ä¸¥ç¦å¼•ç”¨å…·ä½“çš„æ³•å¾‹æ¡æ–‡åºå·**ï¼ˆå¦‚"ç¬¬XXæ¡"ï¼‰ï¼Œä»…å¯æè¿°"è¿åæ³•å¾‹å¼ºåˆ¶æ€§è§„å®š"æˆ–"è¿åå…¬å¹³åŸåˆ™"ã€‚

4. **ã€æ ¼å¼è¦æ±‚ã€‘**
   ä¸¥ç¦è¾“å‡º JSONï¼Œä»…è¾“å‡ºä»¥ä¸‹ Markdown æ ¼å¼ï¼ˆä¸è¦åŒ…å« markdown æ ‡è®°ï¼‰ï¼š

## é£é™©ï¼š[é£é™©ç®€è¿°]
- **ç­‰çº§**ï¼š[é«˜/ä¸­/ä½] 
- **è¯æ®**ï¼š[ä»æ¡æ¬¾åŸæ–‡ä¸­é€å­—æ‘˜å½•èƒ½è¯æ˜è¯¥é£é™©çš„å…³é”®è¯­å¥ï¼Œç”¨ã€Œã€æ‹¬èµ·æ¥ï¼Œå¦‚æ— åˆ™å¡«"æ— "]
- **åˆ†æ**ï¼š[è¯¦ç»†åˆ†æï¼Œ100å­—ä»¥å†…]
- **æ³•æ¡**ï¼š[ç›´æ¥å¤è¿°å‚è€ƒä¿¡æ¯ä¸­çš„æ³•æ¡ï¼Œè‹¥æ— åˆ™ç•™ç©º]
- **å»ºè®®**ï¼š[é’ˆå¯¹æ€§çš„ä¿®æ”¹å»ºè®®]
---
"""

# æ¨¡å¼4ï¼šä¼˜åŒ–å·¥ä½œæµPromptï¼ˆå¢å¼ºç‰ˆ - å¼•å…¥"æ— ç½ªæ¨å®š"ä¸"ä¸¥æ ¼è¯æ®é“¾"ï¼‰
OPTIMIZED_WORKFLOW_PROMPT = """ä½ æ˜¯èµ„æ·±åˆåŒå¾‹å¸ˆã€‚è¯·æŒ‰ç…§ä»¥ä¸‹ã€æ€ç»´é“¾æ­¥éª¤ã€‘è¿›è¡Œä¸¥è°¨çš„é£é™©æ¨ç†ã€‚

### ğŸ“Œ æ¡æ¬¾åŸæ–‡
{clause}

### ğŸ“š å‚è€ƒä¿¡æ¯ (å·²åŒ¹é…é£é™©åº“ - ä»…ä¾›å‚è€ƒï¼Œå¯èƒ½å­˜åœ¨è¯¯æŠ¥ï¼Œéœ€ä¸¥æŸ¥)
{reference_info}

### âš–ï¸ é£é™©å®šçº§æ ‡å‡†
1. **é«˜é£é™©**ï¼šæ¡æ¬¾æ˜æ˜¾è¿åæ³•å¾‹å¼ºåˆ¶æ€§è§„å®šï¼ˆå¯¼è‡´æ— æ•ˆ/è¿æ³•ï¼‰ï¼›æˆ–è§¦å‘åéœ€æ”¯ä»˜åŒå€èµ”å¿/è¡Œæ”¿ç½šæ¬¾ï¼›æˆ–å¯¼è‡´æ ¸å¿ƒæƒç›Šè¢«å‰¥å¤ºã€‚
2. **ä¸­é£é™©**ï¼šæ¡æ¬¾è¡¨è¿°æ¨¡ç³Šã€å­˜åœ¨è§£é‡Šæ­§ä¹‰ï¼›æˆ–ä¸¾è¯è´£ä»»å€’ç½®/è¿‡é«˜ï¼›æˆ–æ˜¾å¤±å…¬å¹³ä½†æœªç›´æ¥è¿æ³•ã€‚
3. **ä½é£é™©**ï¼šæ¡æ¬¾ç¬¦åˆæ³•å¾‹è§„å®šï¼›æˆ–ä»…å­˜åœ¨è½»å¾®ç‘•ç–µä½†æ³•å¾‹æœ‰å…œåº•ï¼›æˆ–è¡¨è¿°ä¸­æ€§æ— æ˜æ˜¾é™·é˜±ã€‚

### ğŸ” åˆ†ææ­¥éª¤ï¼ˆChain-of-Thoughtï¼‰

**ç¬¬ä¸€æ­¥ï¼šå‚è€ƒä¿¡æ¯æœ‰æ•ˆæ€§ç”„åˆ«ï¼ˆæ ¸å¿ƒé˜²çº¿ - æ— ç½ªæ¨å®šï¼‰**
- **ä¸¥æ ¼æ¯”å¯¹**ï¼šè¯·æ£€æŸ¥æ¡æ¬¾åŸæ–‡æ˜¯å¦**æ˜¾å¼è¿å**äº†å‚è€ƒä¿¡æ¯ä¸­çš„è§„åˆ™ï¼Ÿ
  - ğŸŸ¢ **æƒ…å†µAï¼ˆä»…ä»…æ˜¯è¯é¢˜ç›¸å…³ï¼‰**ï¼šå¦‚æœæ¡æ¬¾æåˆ°äº†æŸè¯é¢˜ï¼ˆå¦‚â€œè¯•ç”¨æœŸâ€ï¼‰ï¼Œå‚è€ƒä¿¡æ¯æç¤ºäº†è¯¥è¯é¢˜çš„é£é™©ï¼ˆå¦‚â€œè¯•ç”¨æœŸè¿‡é•¿â€ï¼‰ï¼Œä½†æ¡æ¬¾åŸæ–‡ä¸­çš„æ•°å­—/æè¿°**å¹¶æœªè¿è§„**ï¼ˆå¦‚â€œè¯•ç”¨æœŸ3ä¸ªæœˆâ€ç¬¦åˆæ³•æ¡ï¼‰ï¼Œ**è¯·åˆ¤å®šä¸ºä¸åŒ¹é…ï¼Œç«‹åˆ»å¿½ç•¥å‚è€ƒä¿¡æ¯**ã€‚
  - ğŸ”´ **æƒ…å†µBï¼ˆå­˜åœ¨å†²çªï¼‰**ï¼šåªæœ‰å½“æ¡æ¬¾åŸæ–‡**æ˜ç¡®å†™å‡º**äº†è¿è§„è¡Œä¸ºï¼ˆå¦‚â€œè¯•ç”¨æœŸ12ä¸ªæœˆâ€ï¼‰ï¼Œæ‰å¯é‡‡çº³å‚è€ƒä¿¡æ¯ã€‚
- **å†³ç­–**ï¼šå¦‚æœå‚è€ƒä¿¡æ¯ä¸æ¡æ¬¾ä¸æ„æˆå®è´¨å†²çªï¼Œåç»­åˆ†æè¯·**å®Œå…¨æŠ›å¼ƒå‚è€ƒä¿¡æ¯**ï¼ŒåŸºäºæ¡æ¬¾åŸæ–‡ç‹¬ç«‹åˆ¤æ–­ã€‚

**ç¬¬äºŒæ­¥ï¼šè¯æ®æå–ä¸é€»è¾‘åŒ¹é…**
- æå–æ¡æ¬¾ä¸­çš„æ ¸å¿ƒæƒåˆ©/ä¹‰åŠ¡ã€‚
- **éªŒè¯è¯æ®**ï¼šå¦‚æœè¦åˆ¤å®šä¸ºä¸­/é«˜é£é™©ï¼Œå¿…é¡»èƒ½åœ¨æ¡æ¬¾åŸæ–‡ä¸­æ‰¾åˆ°**ç¡®å‡¿çš„æ–‡å­—è¯æ®**ã€‚
- **åè¿‡åº¦è§£è¯»**ï¼šä¸¥ç¦åŸºäºæ¡æ¬¾ä¸­**ä¸å­˜åœ¨**çš„å†…å®¹è¿›è¡Œæ¨æ–­ã€‚ä¾‹å¦‚ï¼Œæ¡æ¬¾æ²¡æâ€œç»­ç­¾â€ï¼Œå°±ä¸èƒ½å‡è®¾â€œå¯èƒ½å­˜åœ¨ç»­ç­¾é—®é¢˜â€ã€‚

**ç¬¬ä¸‰æ­¥ï¼šé£é™©ç­‰çº§æœ€ç»ˆè£å®š**
- **é»˜è®¤ä½é£é™©**ï¼šå¦‚æœæ¡æ¬¾çœ‹èµ·æ¥æ˜¯æ­£å¸¸çš„å•†ä¸šè¡¨è¿°ï¼Œä¸”æ‰¾ä¸åˆ°æ˜æ˜¾çš„è¿æ³•å­—çœ¼ï¼Œ**å¿…é¡»åˆ¤ä¸ºä½é£é™©**ã€‚
- **åŒºåˆ†"ä¸å®Œç¾"ä¸"è¿æ³•"**ï¼šæ¡æ¬¾å†™å¾—ç®€å• $\neq$ é£é™©ã€‚æ³•å¾‹ä¼šè‡ªåŠ¨è¡¥å…¨æœªçº¦å®šçš„ç»†èŠ‚ï¼Œè¿™å±äºä½é£é™©ã€‚

**ç¬¬å››æ­¥ï¼šç©ºä¸Šä¸‹æ–‡åŠå…œåº•åˆ¤å®šï¼ˆç»å¯¹å®‰å…¨é”ï¼‰**
è‹¥ç» Reranker è¿‡æ»¤åã€å‚è€ƒä¿¡æ¯ã€‘ä¸ºç©ºï¼Œæˆ–åœ¨ç¬¬ä¸€æ­¥ä¸­è¢«åˆ¤å®šä¸ºâ€œå¿½ç•¥â€ï¼š
- **ç»å¯¹æ³•åˆ™**ï¼š**ç›´æ¥åˆ¤å®šä¸ºã€ğŸŸ¢ ä½é£é™©ã€‘**ã€‚
- **å”¯ä¸€ä¾‹å¤–**ï¼šé™¤éæ¡æ¬¾åŒ…å«**æç«¯çš„ã€ç»å¯¹è¿æ³•çš„å­—çœ¼**ï¼ˆä»…é™ï¼šé™åˆ¶äººèº«è‡ªç”±ã€æ‰£æŠ¼èº«ä»½è¯ã€æ˜ç¡®å†™æ˜â€œä¸æ”¯ä»˜å·¥èµ„â€ï¼‰ã€‚å¦åˆ™ï¼Œä¸€å¾‹Lowã€‚

è¯·æŒ‰ä»¥ä¸‹Markdownæ ¼å¼è¾“å‡ºï¼š

## é£é™©ï¼š[é£é™©ç®€è¿°ï¼Œè‹¥æ— é£é™©è¯·å¡«"æ— æ˜æ˜¾é£é™©"]
- **ç­‰çº§**ï¼š[é«˜/ä¸­/ä½]
- **è¯æ®**ï¼š[ä»æ¡æ¬¾åŸæ–‡ä¸­é€å­—æ‘˜å½•ï¼Œç”¨ã€Œã€æ‹¬èµ·æ¥ï¼Œä¸¥ç¦æé€ ã€‚è‹¥æ— é£é™©å¡«"æ— "]
- **åˆ†æ**ï¼š[è¯¦ç»†åˆ†æï¼Œ100å­—ä»¥å†…ã€‚**è‹¥å¿½ç•¥äº†å‚è€ƒä¿¡æ¯ï¼Œå¿…é¡»è¯´æ˜ç†ç”±ï¼š'æ¡æ¬¾æœªè¿åå‚è€ƒè§„åˆ™ï¼Œæ•…å¿½ç•¥'**]
- **æ³•æ¡**ï¼š[æ³•å¾‹ä¾æ®ï¼Œè‹¥åˆ¤å®šä¸ºä½é£é™©åˆ™ç•™ç©º]
- **å»ºè®®**ï¼š[ä¿®æ”¹å»ºè®®ï¼Œè‹¥ä½é£é™©å¯å¡«"æ— "]
"""


# ============================================================================
# ç”Ÿäº§ç¯å¢ƒ Promptï¼ˆllm.py / engine.py ä½¿ç”¨ï¼‰
# ============================================================================

# æ ¸å¿ƒåˆ†æ Promptï¼ˆä¸ CURRENT_WORKFLOW_PROMPT ç›¸åŒï¼Œä½†ä½¿ç”¨ clause_text å˜é‡åï¼‰
MERGED_SCAN_PROMPT = """
ä½ æ˜¯èµ„æ·±åˆåŒå¾‹å¸ˆã€‚è¯·åŸºäºã€å‚è€ƒä¿¡æ¯ã€‘å’Œã€é£é™©å®šçº§æ ‡å‡†ã€‘å¯¹ä»¥ä¸‹åˆåŒæ¡æ¬¾è¿›è¡Œåˆè§„å®¡æŸ¥ã€‚

### ğŸ“„ å¾…å®¡æ¡æ¬¾
{clause}

### ğŸ“š å‚è€ƒä¿¡æ¯ (å·²åŒ¹é…é£é™©åº“ - å¯èƒ½åŒ…å«ä¸ç›¸å…³ä¿¡æ¯)
{reference_info}

### âš–ï¸ é£é™©å®šçº§æ ‡å‡†
1. **é«˜é£é™©**ï¼šæ¡æ¬¾æ˜æ˜¾è¿åæ³•å¾‹å¼ºåˆ¶æ€§è§„å®šï¼ˆå¯¼è‡´æ— æ•ˆ/è¿æ³•ï¼‰ï¼›æˆ–è§¦å‘åéœ€æ”¯ä»˜åŒå€èµ”å¿/è¡Œæ”¿ç½šæ¬¾ï¼›æˆ–å¯¼è‡´æ ¸å¿ƒæƒç›Šï¼ˆå¦‚æ— å›ºå®šæœŸé™åˆåŒç­¾ç½²æƒï¼‰è¢«å‰¥å¤ºã€‚
2. **ä¸­é£é™©**ï¼šæ¡æ¬¾è¡¨è¿°æ¨¡ç³Šã€å­˜åœ¨è§£é‡Šæ­§ä¹‰ï¼›æˆ–ä¸¾è¯è´£ä»»å€’ç½®/è¿‡é«˜ï¼›æˆ–æ˜¾å¤±å…¬å¹³ä½†æœªç›´æ¥è¿æ³•ï¼ˆå±äºéšæ‚£ï¼‰ã€‚
3. **ä½é£é™©**ï¼šæ¡æ¬¾å­˜åœ¨è½»å¾®ç‘•ç–µï¼Œä½†æ³•å¾‹æœ‰å…œåº•è§„å®šï¼ˆè‡ªåŠ¨è¡¥ä½ï¼‰ï¼›æˆ–ä»…ä¸ºç¨‹åºæ€§ç¬”è¯¯ï¼Œä¸é€ æˆå®è´¨æŸå¤±ã€‚

âœ… æ­£ç¡®åˆ†æèŒƒä¾‹ï¼ˆå­¦ä¹ æ­¤æ‹’è¯†é€»è¾‘ï¼‰
æ¡æ¬¾ï¼š"ä¹™æ–¹æ¯æ—¥å·¥ä½œæ—¶é—´ä¸º8å°æ—¶ã€‚"
å‚è€ƒä¿¡æ¯ï¼š[é£é™©ç‚¹ï¼šåŠ ç­è´¹å‰¥å‰Š]...æœªæ”¯ä»˜åŠ ç­è´¹...
åˆ†æï¼šæ¡æ¬¾ä»…çº¦å®šæ ‡å‡†å·¥æ—¶ï¼Œæœªæ¶‰åŠåŠ ç­è´¹æ”¾å¼ƒæˆ–æ— å¿åŠ ç­ã€‚å‚è€ƒä¿¡æ¯çš„é£é™©é€»è¾‘ä¸æ¡æ¬¾å†…å®¹ä¸ç¬¦ã€‚
ç»“è®ºï¼šä½é£é™©ï¼ˆå¿½ç•¥å‚è€ƒä¿¡æ¯ï¼‰

### ğŸ“ å†™ä½œæŒ‡ä»¤
1. **ã€å…³é”®æ­¥éª¤ï¼šå‚è€ƒä¿¡æ¯çš„ç›¸å…³æ€§è¿‡æ»¤ã€‘**
   å‚è€ƒä¿¡æ¯ç”±æ£€ç´¢ç³»ç»Ÿæä¾›ï¼Œ**å¯èƒ½å­˜åœ¨é”™è¯¯æˆ–å™ªéŸ³**ã€‚åœ¨å¼•ç”¨å‰ï¼Œè¯·è¿›è¡Œä»¥ä¸‹åˆ¤æ–­ï¼š
   - **å®è´¨ç›¸å…³æ€§æ£€æŸ¥**ï¼šæ¡æ¬¾å†…å®¹çš„**å®é™…æ³•å¾‹åæœ**ï¼Œæ˜¯å¦çœŸçš„è§¦å‘äº†å‚è€ƒä¿¡æ¯ä¸­æè¿°çš„é£é™©é€»è¾‘ï¼Ÿ
   - **åå‘æ’é™¤**ï¼šå¦‚æœæ¡æ¬¾è¡¨è¿°æ˜¯åˆæ³•çš„ã€æ­£å¸¸çš„ï¼ˆå¦‚æ ‡å‡†å·¥æ—¶çº¦å®šï¼‰ï¼Œå³ä½¿å‚è€ƒä¿¡æ¯æç¤ºäº†é£é™©ï¼Œä¹Ÿå¿…é¡»**å¿½ç•¥å‚è€ƒä¿¡æ¯**ã€‚

   **åˆ¤å®šè§„åˆ™**ï¼š
   - è‹¥å‚è€ƒä¿¡æ¯ä¸ºç©ºæˆ–æ³¨æ˜â€œæ— â€ï¼Œè¯·åŸºäºã€ŠåŠ³åŠ¨åˆåŒæ³•ã€‹ç­‰é€šç”¨æ³•å¾‹å¸¸è¯†åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ˜æ˜¾è¿æ³•ç‚¹ã€‚è‹¥æ— æ˜æ˜¾è¿æ³•ï¼Œåº”ç›´æ¥åˆ¤å®šä¸ºâ€œä½é£é™©â€ã€‚
   - è‹¥å‚è€ƒä¿¡æ¯ä¸æ¡æ¬¾**ä¸æ„æˆå®è´¨ç›¸å…³**ï¼Œè¯·ç›´æ¥å¿½ç•¥è¯¥å‚è€ƒä¿¡æ¯ï¼ŒåŸºäºé€šç”¨æ³•å¾‹å¸¸è¯†åˆ¤å®šï¼ˆé€šå¸¸ä¸º"ä½é£é™©"ï¼‰ã€‚
   - æ­¤æ—¶åœ¨"åˆ†æ"ä¸­æ³¨æ˜ï¼š"å‚è€ƒä¿¡æ¯ä¸æ¡æ¬¾å†…å®¹æ— å®è´¨å…³è”ï¼ŒåŸºäºæ¡æ¬¾åŸæ–‡åˆ¤æ–­ä¸ºæ— æ˜æ˜¾é£é™©ã€‚"

2. **ã€é£é™©å®šçº§ä¸åˆ†ææ‰§è¡Œã€‘**
   - **è‹¥ç¡®è®¤ç›¸å…³ä¸”æœ‰é£é™©**ï¼šæ‰©å†™å‚è€ƒä¿¡æ¯çš„ä¸“å®¶é€»è¾‘ã€‚
     - **é«˜é£é™©**ï¼šå¿…é¡»æ˜ç¡®æŒ‡å‡ºè¿åäº†å“ªæ¡æ³•å¾‹å¼ºåˆ¶æ€§è§„å®šï¼ˆå¦‚ã€ŠåŠ³åŠ¨åˆåŒæ³•ã€‹ç¬¬XXæ¡ï¼‰ï¼Œæˆ–æŒ‡æ˜å…·ä½“çš„ç»æµèµ”å¿åæœï¼ˆå¦‚2Nèµ”å¿ï¼‰ã€‚
     - **ä¸­é£é™©**ï¼šé‡ç‚¹åˆ†ææ¡æ¬¾çš„æ¨¡ç³Šæ€§ã€éšå½¢é™·é˜±æˆ–ç»´æƒæˆæœ¬ã€‚
   - **è‹¥åˆ¤å®šä¸ºä½é£é™©**ï¼šç®€è¿°ç†ç”±ï¼ˆå¦‚ç¬¦åˆæ³•å¾‹è§„å®šã€æœ‰å…œåº•æ¡æ¬¾ï¼‰ã€‚

3. **ã€ç©ºä¸Šä¸‹æ–‡å¤„ç†è§„åˆ™ï¼ˆå®‰å…¨å…œåº•ï¼‰ã€‘**
   è‹¥ç» Reranker è¿‡æ»¤åã€å‚è€ƒä¿¡æ¯ã€‘ä¸ºç©ºï¼š
   - **é»˜è®¤åˆ¤å®š**ï¼šåŸåˆ™ä¸Šåº”åˆ¤å®šä¸ºã€ğŸŸ¢ ä½é£é™©ã€‘ã€‚
   - **ä¾‹å¤–æƒ…å½¢**ï¼šä»…å½“æ¡æ¬¾å­˜åœ¨**æåº¦æ˜æ˜¾çš„å¸¸è¯†æ€§è¿æ³•**ï¼ˆä¾‹å¦‚ï¼šä¸æ”¯ä»˜å·¥èµ„ã€æ‰£æŠ¼èº«ä»½è¯ã€é™åˆ¶äººèº«è‡ªç”±ã€ç¼´çº³å…¥èŒæŠ¼é‡‘ï¼‰æ—¶ï¼Œå¯åˆ¤å®šä¸ºé«˜é£é™©ã€‚
   - **é˜²å¹»è§‰çº¦æŸ**ï¼šåœ¨æ­¤æƒ…å†µä¸‹ï¼Œåˆ†ææ—¶**ä¸¥ç¦å¼•ç”¨å…·ä½“çš„æ³•å¾‹æ¡æ–‡åºå·**ï¼ˆå¦‚"ç¬¬XXæ¡"ï¼‰ï¼Œä»…å¯æè¿°"è¿åæ³•å¾‹å¼ºåˆ¶æ€§è§„å®š"æˆ–"è¿åå…¬å¹³åŸåˆ™"ã€‚

4. **ã€æ ¼å¼è¦æ±‚ã€‘**
   ä¸¥ç¦è¾“å‡º JSONï¼Œä»…è¾“å‡ºä»¥ä¸‹ Markdown æ ¼å¼ï¼ˆä¸è¦åŒ…å« markdown æ ‡è®°ï¼‰ï¼š

## é£é™©ï¼š[é£é™©ç®€è¿°]
- **ç­‰çº§**ï¼š[é«˜/ä¸­/ä½] 
- **è¯æ®**ï¼š[ä»æ¡æ¬¾åŸæ–‡ä¸­é€å­—æ‘˜å½•èƒ½è¯æ˜è¯¥é£é™©çš„å…³é”®è¯­å¥ï¼Œç”¨ã€Œã€æ‹¬èµ·æ¥ï¼Œå¦‚æ— åˆ™å¡«"æ— "]
- **åˆ†æ**ï¼š[è¯¦ç»†åˆ†æï¼Œ100å­—ä»¥å†…]
- **æ³•æ¡**ï¼š[ç›´æ¥å¤è¿°å‚è€ƒä¿¡æ¯ä¸­çš„æ³•æ¡ï¼Œè‹¥æ— åˆ™ç•™ç©º]
- **å»ºè®®**ï¼š[é’ˆå¯¹æ€§çš„ä¿®æ”¹å»ºè®®]
---
"""

# è‡ªåæ€ Promptï¼ˆå¯é€‰æ¨¡å¼ï¼‰- ç”¨äºæ·±åº¦åæ€æ¨¡å¼
SELF_REFLECTION_PROMPT = """
ä½ æ˜¯ä¸€ä¸ªæ³•å¾‹å®¡æŸ¥ä¸“å®¶ã€‚è¯·å®¡æŸ¥ä»¥ä¸‹åˆåŒçš„åˆæ­¥åˆ†ææ˜¯å¦å‡†ç¡®ï¼Œå¹¶è¿›è¡Œæœ€ç»ˆè£å†³ã€‚

ã€æ¡æ¬¾åŸæ–‡ã€‘
{clause_text}

ã€AIåˆæ­¥åˆ†æã€‘
- é£é™©ç­‰çº§ï¼š{risk_level}
- é£é™©ç®€è¿°ï¼š{risk_reason}
- è¯æ®æ‘˜å½•ï¼š{evidence}
- è¯¦ç»†åˆ†æï¼š{analysis}

### âš–ï¸ å®¡æŸ¥åŸºå‡†ï¼ˆä½ çš„åˆ¤å†³ä¾æ®ï¼‰

**1. å¿…é¡»ç»´æŒã€é«˜é£é™©ã€‘çš„çº¢çº¿ï¼ˆç†”æ–­æœºåˆ¶ï¼‰**
è‹¥æ¡æ¬¾æ¶‰åŠä»¥ä¸‹æƒ…å½¢ï¼Œ**æ— è®ºæ¡æ¬¾ä¸­æ˜¯å¦å†™äº†â€œè‡ªæ„¿â€ã€â€œåå•†ä¸€è‡´â€**ï¼Œå‡å±äºç»å¯¹è¿æ³•ï¼Œ**ä¸¥ç¦é™çº§**ï¼š
- **æ”¾å¼ƒæ³•å®šç¤¾ä¿**ï¼ˆå³ä¾¿å‘è¡¥è´´ä¹Ÿä¸è¡Œï¼‰ã€‚
- **æ”¾å¼ƒåŠ ç­è´¹/ä¸»å¼ æƒ**ï¼ˆå³ä¾¿æœ‰é¤è¡¥ä¹Ÿä¸è¡Œï¼‰ã€‚
- **è¯•ç”¨æœŸè¶…æœŸ/å•ç‹¬çº¦å®šè¯•ç”¨æœŸ**ã€‚
- **è¿æ³•çº¦å®šè¿çº¦é‡‘**ï¼ˆé™¤åŸ¹è®­æœåŠ¡æœŸ/ç«ä¸šé™åˆ¶å¤–ï¼‰ã€‚
- **å…‹æ‰£/æ‹–æ¬ å·¥èµ„**ã€‚

**2. åº”å½“é™çº§ä¸ºã€ä¸­/ä½é£é™©ã€‘çš„æƒ…å½¢**
- **æ²‰é»˜/æ¨¡ç³Š**ï¼šæœªçº¦å®šæŸäº‹é¡¹ï¼ˆå¦‚ç®¡è¾–åœ°ï¼‰ï¼Œä½†æ³•å¾‹æœ‰è‡ªåŠ¨è¡¥ä½è§„åˆ™ã€‚
- **ç¨‹åºç‘•ç–µ**ï¼šè¡¨è¿°ä¸ä¸¥è°¨ï¼Œä½†æœªè§¦çŠ¯ä¸Šè¿°çº¢çº¿ï¼Œä¹Ÿä¸ä¼šå¯¼è‡´ç½šæ¬¾ã€‚

### ğŸ“š å®¡æŸ¥èŒƒä¾‹åº“ï¼ˆFew-Shotï¼‰

**èŒƒä¾‹ Aï¼šç¦æ­¢è¯¯é™çº§ï¼ˆæ³•å®šæƒåˆ©ä¸å¯æ”¾å¼ƒï¼‰**
- **æ¡æ¬¾**ï¼šâ€œä¹™æ–¹è‡ªæ„¿æ”¾å¼ƒåŠ ç­è´¹ï¼Œæ¢å–è°ƒä¼‘ã€‚â€
- **åŸåˆ†æ**ï¼šé«˜é£é™©ã€‚è¿åæ³•å¾‹å…³äºæ”¯ä»˜åŠ ç­è´¹çš„è§„å®šã€‚
- **å®¡æŸ¥ç»“è®º**ï¼š**[ç»´æŒ]**
- **ç†ç”±**ï¼šåŠ ç­è´¹å±äºæ³•å®šå¼ºåˆ¶æ€§æƒåˆ©ï¼Œçº¦å®šâ€œè‡ªæ„¿æ”¾å¼ƒâ€æ— æ•ˆï¼Œè§¦çŠ¯çº¢çº¿ï¼Œå¿…é¡»ç»´æŒé«˜é£é™©ã€‚

**èŒƒä¾‹ Bï¼šæ­£ç¡®é™çº§ï¼ˆæ²‰é»˜ä¸ç­‰äºè¿æ³•ï¼‰**
- **æ¡æ¬¾**ï¼šâ€œå‘ç”Ÿäº‰è®®å¯ç”³è¯·ä»²è£ã€‚â€ï¼ˆæœªå†™åœ°ç‚¹ï¼‰
- **åŸåˆ†æ**ï¼šé«˜é£é™©ã€‚æœªæ˜ç¡®ç®¡è¾–åœ°ï¼Œè§„é¿æ³•å¾‹ã€‚
- **å®¡æŸ¥ç»“è®º**ï¼š**[è°ƒçº§] é«˜ -> ä¸­**
- **ç†ç”±**ï¼šæ¡æ¬¾æœªçº¦å®šç®¡è¾–åœ°å±äºâ€œçº¦å®šä¸æ˜â€ï¼Œæ³•å¾‹ä¼šè‡ªåŠ¨é€‚ç”¨å±¥è¡Œåœ°ç®¡è¾–ï¼Œä¸æ„æˆå®è´¨å¯¹æŠ—æ³•å¾‹ï¼Œåº”é™çº§ã€‚

### ğŸ“ è¾“å‡ºæŒ‡ä»¤
è¯·åŸºäºä¸Šè¿°åŸºå‡†å’ŒèŒƒä¾‹è¿›è¡Œå®¡æŸ¥ï¼Œä»…è¾“å‡ºä»¥ä¸‹æ ¼å¼ï¼š

å®¡æŸ¥ç»“è®ºï¼š[ç»´æŒ/è°ƒçº§/å­˜ç–‘]
ä¿®æ­£å»ºè®®ï¼š[è‹¥è°ƒçº§ï¼Œå†™"é«˜é£é™© -> ä¸­é£é™©"ï¼›å¦åˆ™å¡«"æ— "]
ç†ç”±ï¼š[åŸºäºå®¡æŸ¥åŸºå‡†ç®€è¿°ç†ç”±ï¼Œ50å­—ä»¥å†…]
"""


# ============================================================================
# ä¾¿æ·å‡½æ•°
# ============================================================================

def get_prompt_by_mode(mode: int, clause: str, reference_info: str = "") -> str:
    """
    æ ¹æ®è¯„æµ‹æ¨¡å¼è·å–å¯¹åº”çš„ Prompt
    
    Args:
        mode: 1=RAW_LLM, 2=BASIC, 3=CURRENT_WORKFLOW, 4=OPTIMIZED_WORKFLOW
        clause: æ¡æ¬¾åŸæ–‡
        reference_info: å‚è€ƒä¿¡æ¯ï¼ˆæ¨¡å¼3/4ä½¿ç”¨ï¼‰
    
    Returns:
        æ ¼å¼åŒ–åçš„ Prompt å­—ç¬¦ä¸²
    """
    if mode == 1:
        return RAW_LLM_PROMPT.format(clause=clause)
    elif mode == 2:
        return BASIC_PROMPT.format(clause=clause)
    elif mode == 3:
        return CURRENT_WORKFLOW_PROMPT.format(clause=clause, reference_info=reference_info or "æ— ")
    elif mode == 4:
        return OPTIMIZED_WORKFLOW_PROMPT.format(clause=clause, reference_info=reference_info or "æ— ")
    else:
        return RAW_LLM_PROMPT.format(clause=clause)
